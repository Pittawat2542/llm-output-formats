<game>
    <character>
        <id>CharacterID001</id>
        <first-name>John</first-name>
        <last-name>Doe</last-name>
        <species>Human</species>
        <age>27</age>
        <role>Protagonist</role>
        <background>John was born in a small village and grew up with his father after his mother passed away when he was young.</background>
        <place-of-birth>Small Village in the Middle of Nowhere</place-of-birth>
		<physical-appearance>
			<physical-appearance>
				<eye-color>Brown</eye-color>
				<hair-color>Blonde</hair-color>
				<height>178cm</height>
				<weight>79kg</weight>
			</physical-appearance>
		</physical-appearance>
    </character>
</game>
```


```xml
<game>
	<character>
		<id>CharacterID001</id>
		<first-name>John</first-name>
		<last-name>Doe</last-name>
		<species>Human</species>
		<age>27</age>
		<role>Protagonist</role>
		<background>John was born in a small village and grew up with his father after his mother passed away when he was young.</background>
		<place-of-birth>Small Village in the Middle of Nowhere</place-of-birth>
		<physical-appearance>
            <physical-appearance>
				<eye-color>Brown</eye-color>
                <hair-color>Blonde</hair-color>
                <height>178cm</height>
                <weight>79kg</weight>
            </physical-appearance>
        </physical-appearance>
    </character>
</game>
```


```xml
<game>
	<character>
		<id>CharacterID001</id>
		<first-name>John</first-name>
		<last-name>Doe</last-name>
		<species>Human</species>
		<age>27</age>
		<role>Protagonist</role>
		<background>John was born in a small village and grew up with his father after his mother passed away when he was young.</background>
		<place-of-birth>Small Village in the Middle of Nowhere</place-of-birth>
		<physical-appearance>
            <physical-appearance>
				<eye-color>Brown</eye-color>
                <hair-color>Blonde</hair-color>
                <height>178cm</height>
                <weight>79kg</weight>
            </physical-appearance>
        </physical-appearance>
    </character>
</game>
```


```xml
<game>
	<character>
		<id>CharacterID001</id>
		<first-name>John</first-name>
		<last-name>Doe</last-name>
		<species>Human</species>
		<age>27</age>
		<role>Protagonist</role>
		<background>John grew up in a small village with his father following his mother's death when he was young.</background>
		<place-of-birth>Small Village in the Middle of Nowhere</place-of-birth>
		<physical-appearance>
            <physical-appearance>
				<eye-color>Brown</eye-color>
                <hair-color>Blonde</hair-color>
                <height>178cm</height>
                <weight>79kg</weight>
            </physical-appearance>
        </physical-appearance>
    </character>
</game>
```


```xml
<game>
	<character>
		<id>CharacterID001</id>
		<first-name>John</first-name>
		<last-name>Doe</last-name>
		<species>Human</species>
		<age>27</age>
		<role>Protagonist</role>
		<background>Born in a small village, John survived with his father after his mother passed when he was young.</background>
		<place-of-birth>Small Village in the Middle of Nowhere</place-of-birth>
		<physical-appearance>
            <physical-appearance>
				<eye-color>Brown</eye-color>
                <hair-color>Blonde</hair-color>
                <height>178cm</height>
                <weight>79kg</weight>
            </physical-appearance>
        </physical-appearance>
    </character>
</game>
```


```xml
<game>
	<character>
		<id>CharacterID001</id>
		<first-name>John</first-name>
		<last-name>Doe</last-name>
		<species>Human</species>
		<age>27</age>
		<role>Protagonist</role>
		<background>Grew up in a small village, John lived on with his father after mother died when he was young.</background>
		<place-of-birth>Small Village in the Middle of Nowhere</place-of-birth>
		<physical-appearance>
            <physical-appearance>
				<eye-color>Brown</eye-color>
                <hair-color>Blonde</hair-color>
                <height>178cm</height>
                <weight>79kg</weight>
            </physical-appearance>
        </physical-appearance>
    </character>
</game>
```


```xml
<game>
	<character>
		<id>CharacterID001</id>
		<first-name>John</first-name>
		<last-name>Doe</last-name>
		<species>Human</species>
		<age>27</age>
		<role>Protagonist</role>
		<background>Grew up in a small village, John survived with his father after mother died when he was young.</background>
		<place-of-birth>Small Village in the Middle of Nowhere</place-of-birth>
		<physical-appearance>
            <physical-appearance>
				<eye-color>Brown</eye-color>
                <hair-color>Blonde</hair-color>
                <height>178cm</height>
                <weight>79kg</weight>
            </physical-appearance>
        </physical-appearance>
    </character>
</game>
```


```xml
<game>
	<character>
		<id>CharacterID001</id>
		<first-name>John</first-name>
		<last-name>Doe</last-name>
		<species>Human</species>
		<age>27</age>
		<role>Protagonist</role>
		<background>Born and raised in a small village, John lived with his father after mother's death when he was young.</background>
		<place-of-birth>Small Village in the Middle of Nowhere</place-of-birth>
		<physical-appearance>
            <physical-appearance>
				<eye-color>Brown</eye-color>
                <hair-color>Blonde</hair-color>
                <height>178cm</height>
                <weight>79kg</weight>
            </physical-appearance>
        </physical-appearance>
    </character>
</game>
```


```xml
<game>
	<character>
		<id>CharacterID001</id>
		<first-name>John</first-name>
		<last-name>Doe</last-name>
		<species>Human</species>
		<age>27</age>
		<role>Protagonist</role>
		<background>Born and raised in a small village, John survived with the help of his father after mother's passing when he was young.</background>
		<place-of-birth>Small Village in the Middle of Nowhere</place-of-birth>
		<physical-appearance>
            <physical-appearance>
				<eye-color>Brown</eye-color>
                <hair-color>Blonde</hair-color>
                <height>178cm</height>
                <weight>79kg</weight>
            </physical-appearance>
        </physical-appearance>
    </character>
</game>
```


```xml
<game>
	<character>
		<id>CharacterID001</id>
		<first-name>John</first-name>
		<last-name>Doe</last-name>
		<species>Human</species>
		<age>27</age>
		<role>Protagonist</role>
		<background>Born and raised in a small village, John grew up with his father's support after mother passed away when he was young.</background>
		<place-of-birth>Small Village in the Middle of Nowhere</place-of-birth>
		<physical-appearance>
            <physical-appearance>
				<eye-color>Brown</eye-color>
                <hair-color>Blonde</hair-color>
                <height>178cm</height>
                <weight>79kg</weight>
            </physical-appearance>
        </physical-appearance>
    </character>
</game>
```


 ```vbnet
public void Init() {
    using (var xdoc = XDocument.Load("characters.xml")) {
        var root = xdoc.Descendants<Element>("name")[0];
        Name = root.Value;
        var age = root.NextSibling();
        Age = int.Parse(age.Value);
        var gender = root.NextElement();
        if (gender != null) {
            Gender = gender.NameSpace + "Male";
        } else {
            throw new InvalidOperationException("Gender was not found!");
        }
    }
}
```


 ```vbnet
public void Init() {
	using (var xdoc = XDocument.Load("characters.xml")) {
		Element root = xdoc.Descendants<Element>("name")[0];
		Name = root.Value;
		Element age = root.NextSibling();
		Age = int.Parse(age.Value);
		Element gender = root.NextElement();
		if (gender != null) {
			Gender = gender.NameSpace + "Male";
		} else {
			throw new InvalidOperationException("Gender was not found!");
		}
	}
}
```


 ```vbnet
using System;
public class CharacterInfo {
	private string name = "";
	private int age = 0;
	private string genderNameSpace = "";

	public void Init() {
		using (var xdoc = XDocument.Load("characters.xml")) {
			Element root = xdoc.Descendants<Element>("name")[0];
			name = root.Value;
			Element ageNode = root.NextSibling();
			age = int.Parse(ageNode.Value);
			Element gender = root.NextElement();
			if (gender != null) {
				SetGenderInfo(xdoc, gender.NameSpace);
			} else {
				throw new InvalidOperationException("Gender was not found!");
			}
		}
	}

	public string Name { get; set; }
	public int Age { get; set; }
	public string GenderNameSpace { get; private set; }

	private void SetGenderInfo(XDocument xdoc, string genderNameSpace) {
		GenderNameSpace = genderNameSpace;
		string elementName = "Male";
		var genderType = new XElement("type", "type", null);
		genderType.Value = "CharacterGender";
		genderType.Add(new XAttribute("xml:lang:element", "element", null) { Value = elementName });
		genderType.NameSpace = genderNameSpace;
		XElement gender = xdoc.Descendants<XElement>("name")[xdoc.Document.Root.Name()][new XPath("./" + elementName).ToString()];
		Gender = new CharacterGenderInfo {
			NameSpace = gender,
			Type = genderType
		};
	}
}
```


 ```vbnet
public class CharacterInfo {
	private string name = "";
	private int age = 0;
	private string genderNameSpace = "";

	public void Init() {
		using (var xdoc = XDocument.Load("characters.xml")) {
			Element root = xdoc.Descendants<Element>("name")[0];
			name = root.Value;
			Element ageNode = root.NextSibling();
			age = int.Parse(ageNode.Value);
			Element gender = root.NextElement();
			if (gender != null) {
				SetGenderInfo(xdoc, gender.NameSpace);
			} else {
				throw new InvalidOperationException("Gender was not found!");
			}
		}
	}

	public string Name { get; set; }
	public int Age { get; set; }
	public string GenderNameSpace { get; private set; }

	private void SetGenderInfo(XDocument xdoc, string genderNameSpace) {
		GenderNameSpace = genderNameSpace;
		string elementName = "Male";
		XElement genderType = new XElement("type", "type", null);
		genderType.Value = "CharacterGender";
		genderType.Add(new XAttribute("xml:lang:element", "element", null) { Value = elementName });
		XElement gender = xdoc.Descendants<XElement>("name")[xdoc.Document.Root.Name()][new XPath("./" + elementName).ToString()];
		Gender = new CharacterGenderInfo {
			NameSpace = gender,
			Type = genderType
		};
	}

	public void ParseCharacterInfo(XElement character) {
		ParseCharacterName(character);
		var ageNode = character.NextElement();
		Age = int.Parse(ageNode.Value);
		if (character.NextChild() != null) {
			SetGenderInfo(xdoc, character.NextSibling().NameSpace);
		} else {
			throw new InvalidOperationException("Couldn't find gender information!");
		}
	}
}
```


 ```vbnet
using System;
public class CharacterInfo {
	private string name = "";
	private int age = 0;
	private string genderNameSpace = "";

	public void Init() {
		using (var xdoc = XDocument.Load("characters.xml")) {
			Element root = xdoc.Descendants<Element>("name")[0];
			name = root.Value;
			Element ageNode = root.NextSibling();
			age = int.Parse(ageNode.Value);
			Element gender = root.NextElement();
			if (gender != null) {
				SetGenderInfo(xdoc, gender.NameSpace);
			} else {
				throw new InvalidOperationException("Gender was not found!");
			}
		}
	}

	public string Name { get; set; }
	public int Age { get; set; }
	public string GenderNameSpace { get; private set; }

	private void SetGenderInfo(XDocument xdoc, string genderNameSpace) {
		GenderNameSpace = genderNameSpace;
		string elementName = "Male";
		var genderType = new XElement("type", "type", null);
		genderType.Value = "CharacterGender";
		genderType.Add(new XAttribute("xml:lang:element", "element", null) { Value = elementName });
		XElement gender = xdoc.Descendants<XElement>("name")[xdoc.Document.Root.Name()][new XPath("./" + elementName).ToString()];
		Gender = new CharacterGenderInfo {
			NameSpace = gender,
			Type = genderType
		};
	}

	public void ParseCharacterInfo(XElement character) {
		ParseCharacterName(character);
		var ageNode = character.NextChild() as XElement;
		if (ageNode != null) {
			Age = int.Parse(ageNode.Value);
		}
		var genderInfoNode = character.NextChild() as XElement;
		if (genderInfoNode != null) {
			SetGenderInfo(xdoc, new XName(".", genderInfoNode.Name().ToString()).Parent());
		} else {
			throw new InvalidOperationException("Couldn't find gender information!");
		}
	}
}
```

We have extracted the logic of parsing a characterâ€™s name, age and gender into separate methods. This is good practice since it makes the ParserCharacterInfo method smaller and easier to understand, especially for someone who isn't used to XPath expressions.

Also note that we are using a nullable `XElement` instead of an `XElement` for some parameters and method returns, this is done to make our code more robust when dealing with unexpected XML elements or nodes in the input xml file.

To create an instance of CharacterInfo, you can simply call its constructor as shown below:
```vbnet
Dim myCharacterInfo As New CharacterInfo()
```

This will initialize a new CharacterInfo instance, with empty strings for Name and GenderNameSpace and an empty int for Age.